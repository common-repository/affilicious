!function r(o,s,l){function d(t,e){if(!s[t]){if(!o[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(u)return u(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var a=s[t]={exports:{}};o[t][0].call(a.exports,function(e){return d(o[t][1][e]||e)},a,a.exports,r,o,s,l)}return s[t].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)d(l[e]);return d}({1:[function(e,t,i){"use strict";var n=r(e("./views/image-gallery")),a=r(e("./views/tags"));function r(e){return e&&e.__esModule?e:{default:e}}window.carbon=window.carbon||{},function(){var e=window.carbon;if(void 0===e.fields)return;e.fields.View.ImageGallery=n.default,e.fields.View.Tags=a.default}()},{"./views/image-gallery":2,"./views/tags":3}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=carbon.fields.View.Image.extend({events:_.extend({},carbon.fields.View.prototype.events,{"click .c2_open_media":"openMedia","click .carbon-image-remove":"removeImage"}),initialize:function(){carbon.fields.View.prototype.initialize.apply(this),this.on("field:beforeRender",this.loadDescriptionTemplate),this.on("field:rendered",this.sortableImages),this.listenTo(this.model,"change:images",this.updateInput),this.listenTo(this.model,"change:value",this.render)},sortableImages:function(){var e=this,t=this.$("ul.carbon-image-gallery");t.sortable({items:"li.carbon-image",cursor:"move",helper:"clone",scrollSensitivity:42,forcePlaceholderSize:!0,opacity:.75,forceHelperSize:!1,placeholder:"carbon-sortable-placeholder",update:function(){var n=[];t.find("li.carbon-image").each(function(){var e=$(this),t=e.attr("data-image-value"),i=e.find("img").attr("src");n.push({value:t,url:i})}),e.model.set("images",n)}})},openMedia:function(e){var i=this,t=this.model.get("type"),n=(this.model.get("images"),this.model.get("window_button_label")),a=this.model.get("window_label"),r=this.model.get("type_filter"),o=this.model.get("value_type"),s={};s[t]=wp.media.frames.crbMediaField=wp.media({title:a||crbl10n.title,library:{type:r},button:{text:n},multiple:!0});var l=s[t];l.on("select",function(){var e=l.state().get("selection").toJSON(),t=_.clone(i.model.get("images"));_.each(e,function(e){t.push({value:e[o],url:e.url})}),i.model.set("images",t)}),l.open(),e.preventDefault()},updateInput:function(e){console.log(e);var t=this.$("input.carbon-image-gallery-field"),i=e.get("images"),n=_.map(i,function(e){return e.value}).join();t.val(n).trigger("change")},removeImage:function(e){for(var t=this.$(e.currentTarget),i=t.parents("ul.carbon-image-gallery").children(),n=t.parents("li.carbon-image"),a=_.clone(this.model.get("images")),r=i.index(n),o=[],s=0;s<a.length;s++)s!=r&&o.push(a[s]);this.model.set("images",o)}})},{}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=carbon.fields.View.extend({initialize:function(){carbon.fields.View.prototype.initialize.apply(this),this.on("field:rendered",this._initTags),this.listenTo(this.model,"change:visible",this._initTags)},_initTags:function(){var e=this.model.get("tags"),t=this.model.get("maxItems");e?this._initPredefinedTags(e,t):this._initCustomTags(t)},_initPredefinedTags:function(t,e){var i=this,n=this.$el.find(".aff-tags-predefined"),a=n[0].selectize,r=Object.keys(t).map(function(e){return{id:e,text:t[e]}});a?a.enable():n.selectize({plugins:["drag_drop","remove_button"],delimiter:",",persist:!0,create:!0,valueField:"id",labelField:"text",maxOptions:10,searchField:["text"],maxItems:e,options:r,onChange:function(){return i._onChangeTags()}})},_initCustomTags:function(e){var t=this,i=this.$el.find(".aff-tags-custom"),n=i[0].selectize;n?n.enable():i.selectize({plugins:["drag_drop","remove_button"],delimiter:",",persist:!0,maxItems:e,create:!0,onChange:function(){return t._onChangeTags()}})},_onChangeTags:function(){var e=this.$el.find('input[name="'+this.templateVariables.name+'"]');this.model.set("value",e.val())}});i.default=n},{}]},{},[1]);